<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SDJ Online Support</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-orange-500 to-yellow-400 flex flex-col min-h-screen text-white">

  <!-- Header -->
  <header class="text-center py-10">
    <h1 class="text-5xl font-bold drop-shadow-md">SDJ Online Support</h1>
    <p class="text-lg mt-3 opacity-80">Your trusted help center</p>
  </header>

  <!-- Main Content -->
  <main class="flex-grow flex items-center justify-center">
    <div class="bg-white/10 backdrop-blur-lg rounded-2xl shadow-xl p-10 text-center w-11/12 md:w-1/2">
      <h2 class="text-2xl font-semibold mb-6">Welcome to SDJ Support Portal</h2>
      <div class="flex flex-col gap-4">
        <button id="loginBtn" class="bg-white text-orange-600 font-semibold py-3 rounded-xl hover:bg-orange-100 transition">
          Support Login
        </button>
        <button id="supportBtn" class="bg-orange-700 font-semibold py-3 rounded-xl hover:bg-orange-800 transition">
          Online Support
        </button>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="text-center py-6 text-sm bg-black/30 mt-auto">
    <p>Powered by <span class="font-semibold">Dev Studios</span></p>
    <p>Â© 2025 Dev Studios. All rights reserved.</p>
  </footer>

  <!-- Login Modal -->
  <div id="loginModal" class="hidden fixed inset-0 bg-black/60 flex items-center justify-center z-50">
    <div class="bg-white text-gray-900 rounded-2xl p-8 w-80 shadow-xl">
      <h3 class="text-2xl font-semibold mb-4 text-center">Support Login</h3>
      <input id="username" type="text" placeholder="Username" class="w-full mb-3 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400" />
      <input id="password" type="password" placeholder="Password" class="w-full mb-4 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400" />
      <button id="submitLogin" class="w-full bg-orange-600 text-white py-2 rounded-lg hover:bg-orange-700 transition">Login</button>
      <button id="cancelLogin" class="w-full mt-2 bg-gray-300 text-gray-800 py-2 rounded-lg hover:bg-gray-400 transition">Cancel</button>
      <p id="errorMsg" class="text-red-500 text-center mt-3 hidden">Incorrect password. Try again.</p>
    </div>
  </div>

  <!-- Loader -->
  <div id="loaderScreen" class="hidden fixed inset-0 bg-black/70 flex flex-col items-center justify-center text-white z-50">
    <div class="w-12 h-12 border-4 border-t-transparent border-white rounded-full animate-spin"></div>
    <p class="mt-4 text-lg">Logging you in...</p>
  </div>

  <!-- Success Screen -->
  <div id="successScreen" class="hidden fixed inset-0 bg-green-600/90 flex flex-col items-center justify-center text-white z-50">
    <h2 class="text-3xl font-bold mb-2">Successfully Logged in!</h2>
    <p id="welcomeMsg" class="text-xl"></p>
  </div>

  <!-- Chat Screen -->
  <div id="chatScreen" class="hidden fixed inset-0 bg-orange-100 text-gray-800 flex flex-col z-50">
    <header class="bg-orange-600 text-white p-4 text-lg font-semibold flex justify-between items-center">
      <span>SDJ Online Chat</span>
      <button id="exitChat" class="bg-white text-orange-700 px-3 py-1 rounded-md hover:bg-gray-200 transition">Exit</button>
    </header>

    <div id="chatBox" class="flex-1 overflow-y-auto p-4 space-y-2">
      <div class="text-center text-gray-500">Welcome to SDJ Online Support! Type your message below.</div>
    </div>

    <div class="p-4 bg-white flex">
      <input id="chatInput" type="text" placeholder="Type a message..." class="flex-1 border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-400" />
      <button id="sendMsg" class="ml-2 bg-orange-600 text-white px-4 rounded-lg hover:bg-orange-700 transition">Send</button>
    </div>
  </div>

  <script>
    // Elements
    const loginBtn = document.getElementById("loginBtn");
    const loginModal = document.getElementById("loginModal");
    const submitLogin = document.getElementById("submitLogin");
    const cancelLogin = document.getElementById("cancelLogin");
    const loaderScreen = document.getElementById("loaderScreen");
    const successScreen = document.getElementById("successScreen");
    const errorMsg = document.getElementById("errorMsg");
    const usernameInput = document.getElementById("username");
    const passwordInput = document.getElementById("password");
    const welcomeMsg = document.getElementById("welcomeMsg");
    const supportBtn = document.getElementById("supportBtn");
    const chatScreen = document.getElementById("chatScreen");
    const exitChat = document.getElementById("exitChat");
    const chatBox = document.getElementById("chatBox");
    const chatInput = document.getElementById("chatInput");
    const sendMsg = document.getElementById("sendMsg");

    // Generate or retrieve unique username
    let uniqueName = localStorage.getItem("uniqueUsername");
    if (!uniqueName) {
      uniqueName = "Player" + Math.floor(10000 + Math.random() * 90000);
      localStorage.setItem("uniqueUsername", uniqueName);
    }

    // --- LOGIN MODAL ---
    loginBtn.addEventListener("click", () => loginModal.classList.remove("hidden"));
    cancelLogin.addEventListener("click", () => loginModal.classList.add("hidden"));

    submitLogin.addEventListener("click", () => {
      const username = usernameInput.value.trim();
      const password = passwordInput.value.trim();

      if (password === "SDJSupport10") {
        loginModal.classList.add("hidden");
        loaderScreen.classList.remove("hidden");

        setTimeout(() => {
          loaderScreen.classList.add("hidden");
          successScreen.classList.remove("hidden");
          welcomeMsg.textContent = `Welcome, ${username || "User"}!`;
        }, 5000);
      } else {
        errorMsg.classList.remove("hidden");
      }
    });

    // --- CHAT SYSTEM ---
    supportBtn.addEventListener("click", () => {
      chatScreen.classList.remove("hidden");
      loadMessages();
    });

    exitChat.addEventListener("click", () => chatScreen.classList.add("hidden"));

    sendMsg.addEventListener("click", sendMessage);
    chatInput.addEventListener("keypress", e => {
      if (e.key === "Enter") sendMessage();
    });

    // Send message
    function sendMessage() {
      const msg = chatInput.value.trim();
      if (msg === "") return;

      const userMsg = { name: uniqueName, message: msg, time: new Date().toLocaleTimeString() };

      const messages = JSON.parse(localStorage.getItem("chatMessages") || "[]");
      messages.push(userMsg);

      // If it's the first message, trigger SDJ Automations auto-reply
      if (!messages.some(m => m.name === "SDJ Automations")) {
        const botMsg = {
          name: "SDJ Automations",
          message:
            "Greetings! Welcome to SDJ Online Support Portal, I am SDJ Automations. To make it easier for our staff members to know who you are, please state your Roblox username, and your Discord username if you have Discord.",
          time: new Date().toLocaleTimeString()
        };
        messages.push(botMsg);
      }

      localStorage.setItem("chatMessages", JSON.stringify(messages));

      displayMessage(userMsg);
      displayMessage({ name: "SDJ Automations", message: messages[messages.length - 1].message });
      chatInput.value = "";
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    // Display message
    function displayMessage({ name, message }) {
      const msgElement = document.createElement("div");
      const color = name === "SDJ Automations" ? "text-blue-600" : "text-orange-700";
      msgElement.innerHTML = `<span class='font-semibold ${color}'>${name}:</span> ${message}`;
      chatBox.appendChild(msgElement);
    }

    // Load messages
    function loadMessages() {
      chatBox.innerHTML = `<div class="text-center text-gray-500">Welcome back to SDJ Online Support!</div>`;
      const stored = JSON.parse(localStorage.getItem("chatMessages") || "[]");
      stored.forEach(displayMessage);
      chatBox.scrollTop = chatBox.scrollHeight;
    }
  </script>
</body>
</html>
